[supervisord]
nodaemon=true
logfile=/app/logs/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
loglevel=info
pidfile=/app/supervisord.pid

[program:redis]
command=redis-server --appendonly yes --dir /app/data --bind 127.0.0.1
autostart=true
autorestart=true
user=redis
stdout_logfile=/app/logs/redis.log
stderr_logfile=/app/logs/redis-error.log
priority=1

[program:backend]
command=node /app/dist/index.js
directory=/app
autostart=true
autorestart=true
user=nextjs
environment=NODE_ENV="production",REDIS_URL="redis://127.0.0.1:6379"
stdout_logfile=/app/logs/backend.log
stderr_logfile=/app/logs/backend-error.log
priority=10

[program:frontend]
command=node /app/server.js
autostart=true
autorestart=true
user=nextjs
environment=NODE_ENV="production"
stdout_logfile=/app/logs/frontend.log
stderr_logfile=/app/logs/frontend-error.log
priority=10

[group:mcp-proxy]
programs=redis,backend,frontend